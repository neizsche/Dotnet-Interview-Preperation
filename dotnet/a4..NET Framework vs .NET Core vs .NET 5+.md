# .NET Framework vs .NET Core vs .NET 5+ - Complete Guide

## Overview and Evolution

### Historical Context
- **.NET Framework (2002)**: Original Windows-only framework
- **.NET Core (2016)**: Cross-platform, open-source rewrite
- **.NET 5+ (2020)**: Unified platform merging Framework and Core

## Detailed Comparison Table

| Aspect | .NET Framework | .NET Core | .NET 5+ |
|--------|---------------|-----------|---------|
| **Platform Support** | Windows only | Cross-platform (Windows, Linux, macOS) | Cross-platform (Windows, Linux, macOS) |
| **Open Source** | Mostly proprietary | Fully open source | Fully open source |
| **Deployment Model** | System-wide installation | Self-contained or framework-dependent | Self-contained or framework-dependent |
| **Side-by-Side Execution** | Limited (per machine) | Excellent (per application) | Excellent (per application) |
| **Performance** | Good | Better | Best (AOT, Span<T>, etc.) |
| **Microservices Support** | Limited | Excellent | Excellent |
| **Docker Support** | Limited (Windows containers) | Excellent | Excellent |
| **Target Framework Monikers** | net45, net46, net48, etc. | netcoreapp2.1, netcoreapp3.1, etc. | net5.0, net6.0, net7.0, net8.0 |
| **LTS Versions** | 4.8 (last version) | 3.1 | 6.0, 8.0 |
| **Support Lifecycle** | Long-term, but ending | Defined LTS periods | Defined LTS periods |

## When to Use Which Platform

### Use .NET Framework When:
- Maintaining legacy applications
- Windows Forms/WPF apps tied to specific Windows APIs
- Applications requiring technologies not available in .NET Core/5+ (Web Forms, WCF Server)
- Dependencies only available for .NET Framework

### Use .NET Core 3.1 When:
- Maintaining existing .NET Core 3.1 applications
- Need LTS support for cross-platform applications
- Container-based deployments

### Use .NET 5+ When:
- **New development** (always recommended)
- Maximum performance requirements
- Latest features and improvements
- Cloud-native applications
- Microservices architecture

## Side-by-Side Execution

### .NET Framework SxS Limitations
```xml
<!-- Limited to machine-wide installations -->
<configuration>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.8"/>
  </startup>
</configuration>
```

### .NET Core/5+ SxS Advantages
```json
// Each app can have its own runtime
{
  "runtimeOptions": {
    "tfm": "net8.0",
    "framework": {
      "name": "Microsoft.NETCore.App",
      "version": "8.0.0"
    }
  }
}
```

**Key Differences:**
- .NET Framework: One version per machine, potential conflicts
- .NET Core/5+: Each application bundles its required runtime
- No "machine-wide" runtime conflicts

## Target Framework Monikers (TFMs)

### TFM Structure and Evolution

```xml
<!-- Project File Examples -->
<Project Sdk="Microsoft.NET.Sdk">
  
  <!-- .NET Framework -->
  <PropertyGroup>
    <TargetFramework>net48</TargetFramework>
  </PropertyGroup>
  
  <!-- .NET Core -->
  <PropertyGroup>
    <TargetFramework>netcoreapp3.1</TargetFramework>
  </PropertyGroup>
  
  <!-- .NET 5+ -->
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
  </PropertyGroup>
  
  <!-- Multi-targeting -->
  <PropertyGroup>
    <TargetFrameworks>net48;netcoreapp3.1;net8.0</TargetFrameworks>
  </PropertyGroup>
</Project>
```

### TFM Compatibility Matrix

| TFM | Can Reference | Compatible With |
|-----|---------------|-----------------|
| net48 | netstandard2.0, net47, net48 | Windows only |
| netcoreapp3.1 | netstandard2.0, netcoreapp2.1+ | Cross-platform |
| net8.0 | netstandard2.0, netcoreapp3.1+ | Cross-platform |

## Runtime Configuration (.runtimeconfig.json)

### Structure and Purpose
```json
{
  "runtimeOptions": {
    "tfm": "net8.0",
    "framework": {
      "name": "Microsoft.NETCore.App",
      "version": "8.0.0"
    },
    "configProperties": {
      "System.GC.Server": true,
      "System.Runtime.Serialization.EnableUnsafeBinaryFormatterSerialization": false
    },
    "rollForward": "Major"
  }
}
```

### Key Configuration Options

**Roll Forward Policies:**
```json
{
  "rollForward": "Major" // Options: Disable, Minor, Major, LatestPatch
}
```

**GC Settings:**
```json
{
  "System.GC.Server": true,
  "System.GC.Concurrent": true,
  "System.GC.RetainVM": true
}
```

**Threading Settings:**
```json
{
  "System.Threading.ThreadPool.MinThreads": 10,
  "System.Threading.ThreadPool.MaxThreads": 100
}
```

## Probable Questions and Answers

### Basic Level Questions

**Q1: What's the main difference between .NET Framework and .NET Core?**
**A:** .NET Framework is Windows-only and system-wide, while .NET Core is cross-platform and supports side-by-side execution per application.

**Q2: When should I choose .NET 8 over .NET Framework?**
**A:** Always choose .NET 8 for new projects unless you have specific dependencies requiring .NET Framework or need Windows-specific technologies not available in .NET 8.

### Intermediate Level Questions

**Q3: How does side-by-side execution work in .NET Core/5+?**
**A:** Each application can bundle its own runtime version, eliminating conflicts between applications requiring different runtime versions. This is managed through the `.runtimeconfig.json` file.

**Q4: What are TFMs and why are they important?**
**A:** TFMs (Target Framework Monikers) identify the specific .NET platform version your application targets. They determine available APIs, compatibility, and runtime behavior.

### Advanced/Tricky Questions

**Q5: Can I reference a .NET Framework library from a .NET 8 application?**
**A:** Not directly. You need to use .NET Standard 2.0 as a compatibility bridge or find alternative libraries. Some Windows-specific APIs may not be available.

**Reasoning:** .NET Framework and .NET 8 have different base class libraries and runtime characteristics, making direct referencing impossible.

**Q6: What happens if I set `rollForward` to `LatestMajor` in runtimeconfig.json?**
**A:** The runtime will automatically use the latest available major version if the specified version isn't found, which could lead to breaking changes.

**Reasoning:** This setting provides maximum compatibility but risks unexpected behavior due to major version differences.

**Q7: How does multi-targeting work with TFMs?**
**A:** You can specify multiple TFMs in your project file, and the compiler creates separate assemblies for each target.

```xml
<TargetFrameworks>net48;netcoreapp3.1;net8.0</TargetFrameworks>
```

**Q8: What's the difference between framework-dependent and self-contained deployments?**
**A:** Framework-dependent deployments require the .NET runtime to be installed on the target machine, while self-contained deployments include the runtime with your application.

**Q9: How do I handle configuration differences between .NET Framework and .NET 8?**
**A:** .NET Framework uses `web.config/app.config`, while .NET 8 uses `appsettings.json` with different configuration providers.

### Tricky Follow-up Questions

**Q10: Why can't I use Windows Forms in .NET Core/5+ on Linux?**
**A:** Windows Forms relies on Windows-specific APIs (User32, GDI+) that don't exist on Linux. However, .NET 6+ supports Windows Forms on Windows for cross-platform applications.

**Reasoning:** UI frameworks are typically platform-specific due to underlying OS differences.

**Q11: What happens to my WCF services when migrating to .NET 8?**
**A:** WCF server functionality isn't available in .NET 8. You need to:
- Use WCF client functionality (available)
- Migrate to gRPC, REST APIs, or other communication technologies
- Use CoreWCF (community-supported alternative)

**Q12: How does the garbage collector differ between these platforms?**
**A:** .NET Framework primarily uses Workstation GC, while .NET Core/5+ offers more GC flavors including Server GC and region-based GC in newer versions.

**Q13: Can I use ASP.NET Web Forms in .NET 8?**
**A:** No, Web Forms is specific to .NET Framework. You need to migrate to ASP.NET Core MVC, Razor Pages, or Blazor.

### Migration and Compatibility Questions

**Q14: What's the best approach to migrate from .NET Framework to .NET 8?**
**A:** 
1. Use the .NET Upgrade Assistant tool
2. Migrate to .NET Core 3.1 first as intermediate step
3. Address incompatible dependencies
4. Test thoroughly, especially Windows-specific functionality

**Q15: How do I handle AppDomains in .NET 8?**
**A:** AppDomains are largely deprecated. Use AssemblyLoadContext for assembly isolation and process-based isolation for application domains.

### Performance-related Questions

**Q16: Why is .NET 8 generally faster than .NET Framework?**
**A:** 
- Span<T> for efficient memory manipulation
- Better JIT compilation
- Improved GC
- SIMD support
- AOT compilation capabilities

**Q17: What's the impact of AOT compilation in .NET 8?**
**A:** Native AOT produces native executables without JIT, resulting in faster startup and smaller memory footprint but larger file sizes and some reflection limitations.

## Configuration Deep Dive

### Runtime Configuration Examples

**Advanced runtimeconfig.json:**
```json
{
  "runtimeOptions": {
    "tfm": "net8.0",
    "includedFrameworks": [
      {
        "name": "Microsoft.NETCore.App",
        "version": "8.0.0"
      }
    ],
    "configProperties": {
      "System.GC.HeapHardLimit": 1073741824,
      "System.Threading.ThreadPool.MinThreads": 50,
      "System.Runtime.TieredCompilation": true,
      "Microsoft.Extensions.DependencyInjection.VerifyOpenGenericServiceTrimmability": true
    },
    "rollForwardOnNoCandidateFx": 2,
    "rollForward": "Minor"
  }
}
```

### Environment-specific Configurations

**Development vs Production:**
```json
// appsettings.Development.json
{
  "Runtime": {
    "GCServer": false,
    "TieredCompilation": true
  }
}

// appsettings.Production.json  
{
  "Runtime": {
    "GCServer": true,
    "TieredCompilation": false
  }
}
```

This comprehensive guide covers the essential differences and provides deep technical understanding of the .NET ecosystem evolution and current state.
